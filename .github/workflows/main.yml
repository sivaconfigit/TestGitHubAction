
name: Delete Branches

on:
  schedule:  
   - cron: '49 6 * * *'
jobs:

  delete-branches:

    runs-on: windows-latest

    steps:

      - name: Checkout code

        uses: actions/checkout@v2

      - name: Delete branches

        run: |

          $EXCLUDE_BRANCHES = @("main", "master", "develop", "release")
 
          Get-ChildItem -Path "refs/heads/" -Filter "*.git" | ForEach-Object {

            $branch = $_.Name -replace ".git"

            if ($EXCLUDE_BRANCHES -notcontains $branch) {

              git push origin --delete $branch

            }

          }

        env:

          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
